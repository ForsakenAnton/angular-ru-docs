{@a angular-service-worker-introduction}
# Angular сервисный работник введение

Сервис воркеры дополняют традиционную модель веб-развертывания и расширяют возможности приложений, обеспечивая пользователям удобство и надежность на уровне исходного кода. Добавление работника службы в приложение Angular является одним из шагов по превращению приложения в [Progressive Web App](https://developers.google.com/web/progressive-web-apps/)(также известное как PWA).

В простейшем случае сервисный работник - это скрипт, который запускается в веб-браузере и управляет кэшированием приложения.

Сервисные работники функционируют как сетевой прокси. Они перехватывают все исходящие HTTP-запросы, сделанные приложением, и могут выбирать, как на них отвечать. Например, они могут запрашивать локальный кеш и доставлять кешированный ответ, если таковой имеется. Прокси не ограничивается запросами, сделанными через программные API, такие как `fetch` ; он также включает ресурсы, на которые есть ссылки в HTML, и даже первоначальный запрос к `index.html` . Таким образом, кэширование на основе работника сервиса полностью программируется и не зависит от заданных сервером заголовков кэширования.

В отличие от других сценариев, составляющих приложение, таких как пакет приложений Angular, сервисный работник сохраняется после того, как пользователь закрывает вкладку. В следующий раз, когда браузер загружает приложение, сначала загружается сервисный работник, который может перехватывать каждый запрос ресурсов для загрузки приложения. Если сервисный работник предназначен для этого, он может *полностью удовлетворить загрузку приложения без необходимости в сети*.

Даже в быстрой надежной сети двусторонние задержки могут привести к значительной задержке при загрузке приложения. Использование работника службы для уменьшения зависимости от сети может значительно улучшить взаимодействие с пользователем.


{@a service-workers-in-angular}
## Сервисные работники в Angular

Angular приложения, как одностраничные приложения, находятся в выгодном положении, чтобы воспользоваться преимуществами сервисных работников. Начиная с версии 5.0.0, Angular поставляется с реализацией сервисного работника. Разработчики Angular могут воспользоваться преимуществами этого сервисного работника и воспользоваться повышенной надежностью и производительностью, которую он обеспечивает, без необходимости кодирования против низкоуровневых API.

Сервисный работник Angular предназначен для оптимизации работы конечного пользователя с использованием приложения по медленному или ненадежному сетевому соединению, а также минимизирует риски обслуживания устаревшего контента.

Поведение Angular услуг работника следует, что цели дизайна:

* Кэширование приложения похоже на установку нативного приложения. Приложение кэшируется как единое целое, и все файлы обновляются вместе.
* Работающее приложение продолжает работать с той же версией всех файлов. Он не начинает внезапно получать кэшированные файлы из более новой версии, которые, вероятно, несовместимы.
* Когда пользователи обновляют приложение, они видят последнюю полностью кэшированную версию. Новые вкладки загружают последний кешированный код.
* Обновления происходят в фоновом режиме, относительно быстро после публикации изменений. Предыдущая версия приложения обслуживается до тех пор, пока обновление не будет установлено и готово.
* Сервисный работник сохраняет пропускную способность, когда это возможно. Ресурсы загружаются только если они изменились.

Для поддержки такого поведения работник службы Angular загружает *манифеста* файл с сервера. Манифест описывает ресурсы для кэширования и включает в себя хэши содержимого каждого файла. При развертывании обновления приложения содержимое манифеста изменяется, информируя работника службы о необходимости загрузки и кэширования новой версии приложения. Этот манифест генерируется из файла конфигурации, сгенерированного CLI и называемого `ngsw-config.json`.

Установка сервисного работника Angular так же проста, как включение `NgModule` . Помимо регистрации работника службы Angular в браузере, это также делает доступными для внедрения несколько служб, которые взаимодействуют с работником службы и могут использоваться для управления им. Например, приложение может запросить уведомление, когда новое обновление станет доступным, или приложение может попросить работника сервиса проверить сервер на наличие доступных обновлений.

{@a prerequisites}
## Предпосылки

Чтобы использовать все возможности сервисного работника Angular, используйте последние версии Angular и Angular CLI.

Для того, чтобы сервисные работники могли быть зарегистрированы, к приложению необходимо обращаться по HTTPS, а не по HTTP.
Браузеры игнорируют сервисных работников на страницах, которые обслуживаются через незащищенное соединение.
Причина в том, что работники службы являются достаточно мощными, поэтому необходимо проявлять особую осторожность, чтобы сценарий работника службы не был подделан.

Из этого правила есть одно исключение: для облегчения локальной разработки браузеры _не_ не требуют безопасного соединения при доступе к приложению в `localhost`.

{@a browser-support}
### Поддержка браузера

Чтобы воспользоваться преимуществами сервисного работника Angular, ваше приложение должно работать в веб-браузере, который поддерживает сервисных работников в целом.
В настоящее время сервисные работники поддерживаются в последних версиях Chrome, Firefox, Edge, Safari, Opera, UC Browser (версия для Android) и Samsung Internet.
Браузеры, такие как IE и Opera Mini, не поддерживают сервисных работников.

Если пользователь обращается к вашему приложению через браузер, который не поддерживает сервисных работников, сервисный работник не регистрируется, и такое поведение, как автономное управление кэшем и push-уведомления, не происходит.
Более конкретно:

* Браузер не загружает служебный рабочий скрипт и `ngsw.json` манифеста.
* Активные попытки взаимодействия с работником службы, такие как вызов `SwUpdate.checkForUpdate()`, возврат отклоненных обещаний.
* Наблюдаемые события связанных служб, таких как `SwUpdate.available`, не запускается.

Настоятельно рекомендуется убедиться, что ваше приложение работает даже без поддержки сервисного работника в браузере.
Хотя неподдерживаемый браузер игнорирует кэширование работника службы, он все равно будет сообщать об ошибках, если приложение попытается взаимодействовать с работником службы.
Например, позвонив `SwUpdate.checkForUpdate()` вернет отклоненные обещания.
Чтобы избежать такой ошибки, вы можете проверить, включен ли сервисный работник Angular, используя `SwUpdate.isEnabled()`.

Чтобы узнать больше о других браузерах, которые готовы обслуживать работников, см. [Можно ли использовать](https://caniuse.com/#feat=serviceworkers)Страницу и [Документы MDN](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API).


{@a related-resources}
## Связанные ресурсы

Остальные статьи в этом разделе специально посвящены реализации сервисов Angular.

* [App Shell](guide/app-shell)
* [Сервисный работник связи](guide/service-worker-communications)
* [Сервисный работник на производстве](guide/service-worker-devops)
* [Конфигурация сервисного работника](guide/service-worker-config)

Для получения дополнительной информации о сервисных работниках в целом см. [Сервисные работники: введение](https://developers.google.com/web/fundamentals/primers/service-workers/).

Для получения дополнительной информации о поддержке браузера, см [поддержка браузера](https://developers.google.com/web/fundamentals/primers/service-workers/#browser_support)раздел [работники службы: введение](https://developers.google.com/web/fundamentals/primers/service-workers/), Джейк Арчибальд [? Is Serviceworker готов](https://jakearchibald.github.io/isserviceworkerready/), и
[Могу ли я использовать](http://caniuse.com/#feat=serviceworkers).

Дополнительные рекомендации и примеры, см

* [Прекешинг с Angularи службы работника](https://web.dev/precaching-with-the-angular-service-worker/)
* [Создание PWA с Angular CLI](https://web.dev/creating-pwa-with-angular-cli/)

{@a next-steps}
## Следующие шаги

Чтобы начать использовать сервисных работников Angular, см. [Начало работы с сервисными работниками](guide/service-worker-getting-started).
